var cli_query={};function add_query_arg(b,a){url=document.location.href;0>url.indexOf("?")&&(url+="?");return url=url+b+"="+a}
function displayQuery(b){Terminal.setWorking(!0);$.getJSON(wp_unix_i18n.home+"/?json="+b,function(a){Terminal.setWorking(!1);"ok"!=a.status?Terminal.print($("<p>").addClass("error").text(wp_unix_i18n.error)):0==a.count?Terminal.print($("<p>").addClass("error").text(wp_unix_i18n.no_results)):(void 0!=a.post&&displayPost(a.post),void 0!=a.page&&displayPost(a.page),void 0!=a.posts&&listPosts(a.posts),void 0!=a.pages&&listPosts(a.pages))})}
function displayPost(b){Terminal.print("");Terminal.print(b.title);for(line="";line.length<b.title.length;line+="=");Terminal.print(line);"page"!=b.type&&Terminal.print(wp_unix_i18n.posted+$.format.date(b.date,wp_unix_i18n.date_format));Terminal.print("");Terminal.print(b.content);Terminal.print("");"page"!=b.type&&(meta=wp_unix_i18n.meta,meta=meta.replace("%3$s",b.author.name).replace("%2$s",termList(b.categories)).replace("%1$s",termList(b.tags)),Terminal.print(meta));Terminal.print("");history.pushState({page:b.url},
b.url,b.url)}function termList(b){var a=[];$.each(b,function(b,c){a[b]=c.title});return a.join(", ")}function listTerms(b){$.each(b,function(a,b){Terminal.print(b.term_id+". "+b.name)})}function listPosts(b){$.each(b,function(a,b){Terminal.print(b.id+". "+b.title)})}function welcomeMessage(){Terminal.print(wp_unix_i18n.welcome_message)}
$("#screen").bind("cli-load",function(){welcomeMessage();$.each(wp_unix_i18n.pages,function(b,a){TerminalShell.commands[a.slug]=function(b){TerminalShell.process(b,"page "+a.id)}});1==wp_unix_i18n.query.length&&(post=wp_unix_i18n.query[0],Terminal.runCommand(post.type+" "+post.id))});TerminalShell.commands.posts=TerminalShell.commands.ls=TerminalShell.commands.list=function(){0!=wp_unix_i18n.query.length?listPosts(wp_unix_i18n.query):displayQuery("get_recent_posts")};
TerminalShell.commands.pages=function(){displayQuery("get_page_index")};TerminalShell.commands.post=function(b){var a=Array.prototype.slice.call(arguments);a.shift();1==wp_unix_i18n.query.length&&wp_unix_i18n.query[0].id==a?(post=wp_unix_i18n.query.shift(),displayPost(post)):(query="get_post&id="+a,displayQuery(query))};TerminalShell.commands.page=function(b){var a=Array.prototype.slice.call(arguments);a.shift();query="get_page&id="+a;displayQuery(query)};
TerminalShell.commands.su=function(){document.location.href=wp_unix_i18n.home+"/wp-admin/"};TerminalShell.commands.home=function(){document.location.href=wp_unix_i18n.home};TerminalShell.commands.search=function(b){var a=Array.prototype.slice.call(arguments);a.shift();(a=a.join(" "))?displayQuery("1&s="+a):Terminal.print($("<p>").addClass("error").text(wp_unix_i18n.search_error))};
TerminalShell.commands.category=function(b){var a=Array.prototype.slice.call(arguments);a.shift();a=a.shift();displayQuery("get_category_posts&category_id="+a)};TerminalShell.commands.categories=function(){listTerms(wp_unix_i18n.categories)};TerminalShell.commands.tags=function(){listTerms(wp_unix_i18n.tags)};TerminalShell.commands.tag=function(b){var a=Array.prototype.slice.call(arguments);a.shift();a=a.shift();displayQuery("get_tag_posts&tag_id="+a)};